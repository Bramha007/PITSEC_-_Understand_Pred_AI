# configs/cls/test.yaml

seed: 1337
device: cuda
deterministic: true  # Enforces Deterministic CUDA Operations

data:
  root: data/sized_squares_unfilled  # Root Directory Containing Dataset
  limit_per_split: 25                 # Limit Dataset Size For Quick Testing

model:
  model_name: resnet18
  pretrained: true                     # Use Pretrained Weights
  input_size: 224                      # Input Image Size
  out_dim: 2                           # Output Dimension (2 For Regression Targets)

train:
  epochs: 2
  batch_size: 4
  num_workers: 2
  lr: 0.001
  weight_decay: 0.0001
  loss: mse
  log_every: 1                         # Log Every Iteration For Small Batches
  amp: true                             # Enable Automatic Mixed Precision
  clip_grad_norm: 1.0                   # Prevent Large Gradient Spikes
  scheduler:
    name: step
    step_size: 1
    gamma: 0.9                          # Quick LR Decay For Tiny Test Run

eval:
  batch_size: 4
  num_workers: 2
  run_during_train: true                # Evaluate Model During Training

metrics:
  which: [mae, mse, rmse, mape, smape, r2, pearson, bucket_acc, bucket_mae, bucket_rmse]
  bucket_on: long
  bucket_edges: [0, 32, 64, 96, 128, 160, 99999]  # Define Buckets For Error Metrics

early_stopping:
  monitor: overall_rmse                  # Metric To Monitor For Early Stopping

out_dir: outputs/cls/test               # Output Directory For Checkpoints And Metrics
